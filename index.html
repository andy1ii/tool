<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>COSMOS Tool</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
  <script src="https://unpkg.com/ccapture.js@1.1.0/build/CCapture.all.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="sidebar">
    <div>
      <div class="logo-area">
        <img src="resources/cosmos.png" alt="COSMOS">
      </div>
      
      <button id="backBtn" class="sidebar-back-btn" onclick="goToGrid()">
         ‚Üê Back to Menu
      </button>
    </div>

    <div class="controls-wrapper">
        <div id="home-info">
            <p style="font-size: 11px; color: #666; line-height: 1.4; margin-bottom: 20px;">
              A motion generation tool designed for the Cosmos social media page. Use the image library below to manage assets for all motion modes.
            </p>
        </div>

        <div class="control-group">
          <h3>Image Library</h3>
          <div class="flat-input upload-row" onclick="document.getElementById('fileUpload').click()">
            <span id="uploadLabel">Upload Images</span>
            <span class="upload-hint">JPG, PNG</span>
          </div>
          <input type="file" id="fileUpload" hidden multiple onchange="handleImageUpload(this)">
        </div>

        <div id="controls-mode-1" class="mode-controls">
            <div class="control-group">
              <h3>Controls</h3>
              <div class="slider-row">
                <label>Distortion</label>
                <input type="range" min="0" max="100" value="50" id="radiusSlider">
              </div>
              <div class="slider-row">
                <label>Zoom</label>
                <input type="range" min="0" max="100" value="0" id="sizeSlider">
              </div>
              <div class="slider-row">
                <label>Speed</label>
                <input type="range" min="0" max="100" value="50" id="speedSlider">
              </div>
            </div>
            <div class="control-group">
              <h3>User Information</h3>
              <label>Usernames (Cycle)</label>
              <input type="text" class="flat-input" id="user1" placeholder="@cosmos" value="@cosmos" oninput="updateUsernames()">
              <input type="text" class="flat-input" id="user2" placeholder="@design" value="@design" oninput="updateUsernames()">
              <input type="text" class="flat-input" id="user3" placeholder="@motion" value="@motion" oninput="updateUsernames()">
            </div>
        </div>

        <div id="controls-mode-2" class="mode-controls">
           <div class="control-group">
             <h3>Burst Controls</h3>
             <div class="slider-row">
               <label>Image Scale</label>
               <input type="range" min="10" max="250" value="100" id="m2SizeSlider">
             </div>
             <div class="slider-row">
               <label>Spacing / Margins</label>
               <input type="range" min="0" max="100" value="50" id="m2SpacingSlider">
             </div>
             <label style="margin-top:10px;">Interaction</label>
             <button class="flat-input" onclick="shuffleMode2()">Shuffle Layout</button>
           </div>
        </div>

        <div id="controls-mode-3" class="mode-controls">
            <div class="control-group">
              <h3>3D Explosion</h3>
              <div class="slider-row">
                <label>Perspective (FOV)</label>
                <input type="range" min="0" max="100" value="30" id="m3PerspSlider">
              </div>
              <div class="slider-row">
                <label>Camera Distance</label>
                <input type="range" min="0" max="100" value="40" id="m3DistSlider">
              </div>
              <div style="margin-top:10px; font-size:10px; color:#999;">
                Drag on canvas to rotate camera.
              </div>
            </div>
         </div>

        <div id="controls-mode-4" class="mode-controls">
            <div class="control-group">
              <h3>Fisheye Grid</h3>
              <div class="slider-row">
                <label>Distortion Strength</label>
                <input type="range" min="0" max="100" value="50" id="m4DistSlider"> 
              </div>
              <label style="margin-top:10px;">Generative</label>
              <button class="flat-input" onclick="if(typeof rebuildMode4Layout === 'function') rebuildMode4Layout()">Regenerate Layout</button>
            </div>
         </div>

        <div id="controls-mode-5" class="mode-controls">
            <div class="control-group">
              <h3>Vertical Motion</h3>
              <div class="slider-row">
                <label>Speed</label>
                <input type="range" min="1" max="20" value="17" id="m5SpeedSlider"> 
              </div>
              <div class="slider-row">
                <label>Scale (Zoom)</label>
                <input type="range" min="30" max="100" value="60" id="m5ScaleSlider"> 
              </div>
              <div class="control-group">
                <label>Tag Text</label>
                <input type="text" class="flat-input" id="m5TextInput" placeholder="Cosmos Tag" value="Cosmos Tag">
              </div>
            </div>
         </div>
        
        <div id="global-controls" class="mode-controls">
            <div class="control-group">
              <h3>Ratio</h3>
              <select class="flat-input" id="aspectRatioSelect" onchange="resizeCanvasToRatio()">
                <option value="9:16">1080x1920 (Story)</option>
                <option value="4:5">1080x1350 (Portrait)</option>
                <option value="1:1">1080x1080 (Square)</option>
                <option value="16:9">1920x1080 (Landscape)</option>
              </select>
            </div>

            <div class="export-wrapper">
              <button class="export-btn" onclick="triggerImageExport()">PNG</button>
              <button class="export-btn" id="recordBtn" onclick="toggleVideoRecord()">Record Video</button>
            </div>
        </div>
    </div> 
  </div>

  <div class="main-stage" id="stage">
    <div id="canvas-container"></div>
    <img src="resources/logo.png" class="top-icon" alt="Logo">
  </div>

  <script src="mode1.js"></script>
  <script src="mode2.js"></script>
  <script src="mode3.js"></script>
  <script src="mode4.js"></script>
  <script src="mode5.js"></script> <script src="index.js"></script>

</body>
</html>